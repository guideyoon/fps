# FPS 게임 기술 개요 및 가이드 (Game Architecture & Flow)

이 문서는 본 FPS 게임의 기술적 구현 방식과 게임 플레이 메커니즘에 대한 전체적인 개요를 제공합니다.

---

## 1. 기술 스택 (Technical Stack)

이 게임은 별도의 엔진(Unity, Unreal) 없이 웹 기술과 라이브러리를 사용하여 구현되었습니다.

-   **Frontend**: 
    -   **Three.js**: 3D 그래픽 렌더링을 담당 (플레이어, 환경, 무기, 적 모델링).
    -   **Vanilla JS**: 게임 로직, 상태 관리, 이벤트 처리.
    -   **HTML5/CSS3**: 오버레이 UI, 모바일 컨트롤 레이아웃.
    -   **Web Audio API**: 절차적 사운드 생성 및 오디오 파일 재생 (`SoundGen` 객체).
-   **Backend**:
    -   **Node.js & Express**: 게임 서버 프레임워크.
    -   **Socket.IO**: 실시간 양방향 멀티플레이어 통신.
-   **Assets**:
    -   외부 `.mp3` 파일 (효과음).
    -   Three.js Geometries (박스, 원통 등을 조합한 절차적 모델링).

---

## 2. 파일 구조 (File Structure)

-   `FPS.html`: 클라이언트 사이드 통합 파일. HTML structure, CSS styling, Three.js 렌더링 로직, 클라이언트용 소켓 로직이 모두 포함되어 있습니다.
-   `server/server.js`: 멀티플레이어 서버 로직. 방 관리, 플레이어 위치 동기화, 피격 판정, 스폰 포인트 관리 등을 담당합니다.
-   `server/package.json`: 서버 의존성(`express`, `socket.io`) 정의.

---

## 3. 핵심 시스템 (Core Systems)

### 렌더링 및 물리 (Rendering & Physics)
-   **카메라 시스템**: 1인칭 시점(`FirstPersonControls` 유사 구현)으로, 마우스 이동 및 터치 입력을 받아 시점을 회전합니다.
-   **충돌 감지**: `THREE.Box3`를 사용한 AABB(Axis-Aligned Bounding Box) 충돌 방식을 사용합니다. 맵의 벽과 장애물은 `colliders` 배열에 저장되어 플레이어 이동 시마다 체크됩니다.
-   **무기 시스템**: 레이캐스팅(Raycasting)을 사용하여 사격 시 조준점 방향의 타겟을 탐지하고 피해를 입힙니다.

### 멀티플레이어 아키텍처 (Networking)
-   **권한 부여**: 서버(`server.js`)는 스폰 위치 선정 및 방 상태를 관리하며, 클라이언트는 자신의 위치를 실시간(약 60fps)으로 서버에 전송합니다.
-   **동기화**: 서버는 한 플레이어의 위치와 동작(사격, 점프 등)을 수신하면 해당 방의 다른 플레이어들에게 브로드캐스팅하여 실시간성을 유지합니다.

---

## 4. 게임 진행 방식 (Game Flow)

### 1단계: 진입 및 모드 선택
플레이어는 접속 시 `싱글 플레이(좀비 모드)` 혹은 `멀티 플레이(함께하기)`를 선택할 수 있습니다.

### 2단계: 게임 준비
-   **싱글 플레이**: 즉시 공장(Factory) 맵에 투입되어 좀비들로부터 생존합니다.
-   **멀티 플레이**: 닉네임 설정 후 방 목록에서 방을 선택하거나 새로 생성하여 대기실에 입장합니다. 방장이 게임 시작 버튼을 누르면 모든 플레이어가 스폰됩니다.

### 3단계: 게임 플레이 (In-Game)
-   **이동 및 교전**: WASD(PC)나 조이스틱(모바일)을 사용하여 이동하며, 적(좀비 또는 타 유저)을 사살합니다.
-   **아이템 획득**: 적을 사살하면 확률적으로 HP 회복약이나 수류탄이 드랍됩니다.
-   **무기 교체**: 총 4가지 무기(Assault Rifle, Sniper, SMG, Knife) 및 수류탄을 상황에 맞게 교체하며 사용합니다.

### 4단계: 결과 및 재시작
-   플레이어의 HP가 0이 되면 게임 오버 창이 뜨며, 싱글 플레이에서는 결과(킬 수, 생존 시간)를 확인한 후 재시작할 수 있습니다.
-   멀티 플레이에서는 일정 시간 후 지정된 스폰 포인트에서 리스폰됩니다.

---

## 5. 주요 특징 (Key Features)

-   **멀티 플랫폼 지원**: PC(마우스/키보드)와 모바일(터치 패드)에서 모두 플레이 가능하도록 반응형 레이아웃이 적용되어 있습니다.
-   **절차적 사운드**: 파일 로드가 실패하더라도 `Web Audio API`를 통해 기본적인 발소리, 총소리 등을 생성하여 중단 없는 경험을 제공합니다.
-   **최적화**: 무기 모델링 등을 단순한 Geometry 조합으로 구현하여 브라우저 환경에서 높은 프레임률을 유지합니다.
